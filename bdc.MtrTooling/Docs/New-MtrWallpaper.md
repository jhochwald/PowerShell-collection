# New-MtrWallpaper

## SYNOPSIS
Configure a new wallpaper for Microsoft Teams Room (MTR) System

## SYNTAX

### Set 1
```
New-MtrWallpaper [[-Path] <String>] [[-RedComponent] <Int32>] [[-GreenComponent] <Int32>] [[-BlueComponent] <Int32>] [-Check] [-WhatIf] [-Confirm] [<CommonParameters>]
```

## DESCRIPTION
Configure a new wallpaper for Microsoft Teams Room (MTR) System.

This is done by randomly choosing a supported image file from a folder.

Wallpaper is then copied to the proper folder, and a corresponding XML file is also written.

When the system reboots as part of its normal scheduled nightly maintenance,
the new wallpaper is set for the 'Custom' them in MTR.

## EXAMPLES

### -------------------------- EXAMPLE 1 --------------------------
PS C:\\\>
```powershell
New-MtrWallpaper
```

Picks a random image, copies to the root folder, and writes XML file

## PARAMETERS

### Path
Local MTR User root path, as for now this is the same on every MTR device!
Can be a Share (\\\\<MTRHostname\>\\\\C$\\Users\\Skype\\AppData\\Local\\Packages\\Microsoft.SkypeRoomSystem_8wekyb3d8bbwe\\LocalState),
if you have more then one MTR or want to do it remotely!

```yaml
Type: String
Parameter Sets: Set 1
Aliases: ThisRoot

Required: false
Position: 0
Default Value: "$env:HOMEDRIVE\Users\Skype\AppData\Local\Packages\Microsoft.SkypeRoomSystem_8wekyb3d8bbwe\LocalState"
Pipeline Input: True (ByPropertyName, ByValue)
```

### Check
Check if a given Wallpaperfile has the correct resolution

```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: 

Required: false
Position: named
Default Value: False
Pipeline Input: True (ByPropertyName, ByValue)
```

### RedComponent
RedComponent for the template
Default is 100

```yaml
Type: Int32
Parameter Sets: Set 1
Aliases: Red

Required: false
Position: 1
Default Value: 100
Pipeline Input: True (ByPropertyName, ByValue)
```

### GreenComponent
GreenComponent for the template
Default is 100

```yaml
Type: Int32
Parameter Sets: Set 1
Aliases: Green

Required: false
Position: 2
Default Value: 100
Pipeline Input: True (ByPropertyName, ByValue)
```

### BlueComponent
BlueComponent for the template
Default is 100

```yaml
Type: Int32
Parameter Sets: Set 1
Aliases: Blue

Required: false
Position: 3
Default Value: 100
Pipeline Input: True (ByPropertyName, ByValue)
```

### WhatIf


```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: wi

Required: false
Position: named
Default Value: 
Pipeline Input: false
```

### Confirm


```yaml
Type: SwitchParameter
Parameter Sets: Set 1
Aliases: cf

Required: false
Position: named
Default Value: 
Pipeline Input: false
```

### \<CommonParameters\>
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### System.String


### System.Management.Automation.SwitchParameter


### System.Int32


## OUTPUTS

## NOTES

In the code you will find some exaples for more customization. Not scope of this script, but possible.
Please see: https://docs.microsoft.com/en-us/MicrosoftTeams/room-systems/xml-config-file

All Images must be exactly 3840Ã—1080, for Single or dual screen!

If you copy the wallpaper image (wallpaper.jpg), with or without the settings XML,
to different MTR systems the change will not be activated!
The MTR doesn't do a reload or check if a file is changed.
The MTR will reboot every day at 2:30 (AM), then the changes will be activated.

The MTR support .jpg, .jpeg, .png, and .bmp for wallpapers!

My version of the script has no enhancements, at least not yet!
It's just a minor changed version based on the great work of Pat Richard.

## RELATED LINKS

[Online version:](https://www.ucunleashed.com/4323)

[](https://github.com/patrichard/New-MtrWallpaper)

[](https://docs.microsoft.com/en-us/MicrosoftTeams/downloads/ThemingTemplateMicrosoftTeamsRooms_v2.1.psd)

[](https://docs.microsoft.com/en-us/MicrosoftTeams/room-systems/xml-config-file)

[](https://www.ucit.blog/post/configuring-custom-themes-for-microsoft-teams-skype-room-systems)

[](https://www.bing.com/images/search?q=wallpaper+3840x1080&qpvt=wallpaper+3840x1080&form=IGRE&first=1&cw=1680&ch=939)


*Generated by: PowerShell HelpWriter 2020 v2.3.46*
